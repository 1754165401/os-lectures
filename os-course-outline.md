## 教学日历（教学大纲）（48学时）

课程组织与基本目的：

操作系统是计算机系统中负责管理各种软硬件资源的核心系统软件，掌握操作系统的基本原理及其设计实现技术是研究型大学计算机专业本科毕业生的基本要求。

本课程是计算机专业核心课，从计算机系统的视角进行内容组织与调整，以教学操作系统rcore和risc-v CPU为实验环境，讲授操作系统的概念、基本原理和实现技术，并介绍部分当前操作系统研究热点和论文，帮助学生了解和掌握大型复杂系统软件的分析方法和核心设计思路，并为学生充分利用操作系统功能进行应用软件研究和开发打下扎实的基础。

下面的每一讲是两个课时

# 第1讲 操作系统概述  

## 1.1 课程概述 

## 1.2 教学安排 

## 1.3 什么是操作系统

## 1.4 为什么/如何 学习操作系统 

## 1.5 操作系统实例

## 1.6 操作系统的演变

## 1.7 操作系统结构

## 1.8 OS实验概述(目标,内容) 

# 第2讲 操作系统与系统结构和程序设计语言 

## 2.1 计算机系统 for OS （隔离，特权级，中断，I/O）

## 2.2 系统启动流程

## 2.3 多特权级切换

## 2.4 C语言与Linux内核错误

## 2.5 用Rust写操作系统

# 第3讲 中断、异常和系统调用 

## 3.1 中断、异常和系统调用概述

## 3.2 RISC-V 的异常

## 3.3 RISC-V 的系统调用

## 3.4 RISC-V 的中断

## 3.5 中断、异常、系统调用示例 (各种小例子)

# 第四讲 物理内存管理 ：连续内存分配

## 4.1 计算机体系结构和内存层次概述

## 4.2 连续内存分配

## 4.3 碎片整理

## 4.4 伙伴系统 & 其他（slab, region,etc）分配算法与实现

# 第五讲 物理内存管理: 非连续内存分配 

## 5.1 非连续内存分配概述

## 5.2 页式与段式存储管理 

## 5.3 多级页表

## 5.4 反置页表

## 5.5 段页式存储管理

## 5.6 自映射机制

## 5.7 RISC-V的页表机制

# 第6讲 虚拟存储概念

## 6.1 局部性原理

## 6.2 覆盖和交换

## 6.4 虚拟页式存储

## 6.5 缺页异常

## 6.6 RISC-V的缺页异常

# 第7讲 虚拟存储：局部页面置换算法

## 7.1 页面置换算法的概念

## 7.2 最优/最近/最坏/先进先出/最近最久未使用 算法

## 7.3 时钟置换算法和最不常用算法

## 7.4 Belady现象和局部置换算法比较


# 第8讲 虚拟存储：全局页面置换算法

## 8.1 工作集置换算法

## 8.2 缺页率置换算法

## 8.3 抖动和负载控制

## 8.4 面向缓存的页替换算法-FBR

## 8.5 面向缓存的页替换算法-LRU-K 2Q

## 8.6 面向缓存的页替换算法-LIRS

# 第9讲 进程与线程

## 9.1 进程的概念

## 9.2 进程状态

## 9.3 线程的概念

## 9.4 协程的概念

## 9.5 进程地址空间与安全漏洞 

# 第10讲 进程和线程控制

## 10.1 进程切换

## 10.2 进程创建

## 10.3 进程复制

## 10.4 进程加载

## 10.5 进程等待与退出

## 10.6 RISC-V下的进程管理

## 10.7 思考fork的利与弊


# 第11讲 单处理机调度

## 11.1 处理机调度概念

## 11.2 调度准则

## 11.3 先来先服务、短进程优先和最高响应比优先调度算法

## 11.4 时间片轮转、多级反馈队列、公平共享调度算法和Stride调度算法

## 11.5 实时调度

## 11.6 优先级反置


# 第12讲 多处理机调度与实际操作系统调度机制

## 12.1 对称多处理与多核架构

## 12.2 多处理器调度概述

## 12.3 O(1)调度

## 12.4 CFS调度

## 12.5 BFS调度算法


# 第13讲 同步互斥

## 13.1 同步互斥的背景

## 13.2 现实生活中的同步问题

## 13.3 临界区和禁用硬件中断同步方法

## 13.4 基于软件的同步方法

## 13.5 高级抽象的同步方法


# 第14讲 信号量与管程

## 14.1 信号量的基本概念

## 14.2 信号量的设计与实现

## 14.3 管程的设计与实现

## 14.4 哲学家就餐问题

## 14.5 读者-写者问题

# 第15讲 死锁和并发错误检测

## 15.1 死锁概念

## 15.2 死锁处理方法

## 15.3 银行家算法

## 15.4 死锁检测 

## 15.5 并发错误检测

# 第16讲 进程通信 

## 16.1 进程通信概念

## 16.2 信号和管道

## 16.3 Linux信号机制

## 16.4 消息队列和共享内存

## 16.5 dbus

## 16.6 binder


# 第17讲 文件系统概念

## 17.1 文件系统和文件 

## 17.2 文件描述符 

## 17.3 目录、文件别名和文件系统种类

## 17.4 虚拟文件系统 

## 17.5 文件缓存和打开文件 

## 17.6 文件分配 

## 17.7 空闲空间管理

# 第18讲 文件系统实例

## 18.1 FAT文件系统

## 18.2 EXT4文件系统

## 18.3 ZFS文件系统

# 第19讲 I/O

## 19.1 I/O特点

## 19.2 I/O结构

## 19.3 I/O数据传输

## 19.4 磁盘调度

## 19.5 Linux I/O子系统

# 第20讲 异步编程和异步I/O

## 20.1 异步编程背景

## 20.2 Rust语言中的Future

## 20.3 Generator机制和async/await语言机制

## 20.4 Self-Referential Structs & Pin机制

## 20.5 Waker 和 Reactor 机制

# 第21讲 虚拟化 

## 21.1 虚拟化概述

## 21.2 CPU虚拟化

## 21.3 内存虚拟化

## 21.4 I/O虚拟化

# 期中复习

# 期中考试

# 期末复习



# 课程实验

## 实验0：操作系统实验环境和工具
- 实验目的：了解和熟悉操作系统实验的编译方法和流程、基于硬件模拟器的操作系统内核调试方法，复习Rust语言和risc-v汇编语言。
- 实验内容：安装Linux操作系统、Rust编译工具和QEMU硬件模拟器，并熟悉这些系统和工具的使用方法。
## 实验1：系统软件启动与中断处理
- 实验目的：了解OS启动前的软硬件行为和OS启动后的基本功能, 了解中断在操作系统中的重要性
- 实验内容：加载操作系统，操作系统显示一字符串并响应中断。

## 实验2：物理内存管理
- 实验目的：了解操作系统如何管理物理内存，深入理解硬件的分页模式，页表的建立和使用方法，以及物理内存的管理方法。
- 实验内容：实现物理内存分配算法，利用页表项修改来控制地址变换。。

## 实验3：虚拟内存管理
- 实验目的：了解操作系统如何管理虚拟内存，深入理解缺页异常处理过程，以及操作系统如何使用分页模式实现虚存管理。
- 实验内容：实现缺页异常处理和页替换算法，支持虚拟存储管理，为应用提供大于物理内存的虚拟地址空间。 

## 实验4：内核线程管理
- 实验目的：了解操作系统中内核线程创建和执行的过程，以及上下文切换是如何具体实现的。
- 实验内容：实现内核线程创建过程上的资源分配方法，理解线程上下文切换过程。

## 实验5：用户进程管理
- 实验目的：了解操作系统中用户进程的创建过程，以及用户是如何通过系统调用来实现进程管理的。
- 实验内容：实现应用程序加载和子进程创建过程，理解进程管理系统调用的实现过程。
 
## 实验6：调度器
- 实验目的：理解操作系统的调度管理机制，实现一种调度算法。
- 实验内容：熟悉操作系统调度框架，实现一个调度算法。

## 实验7：同步互斥
- 实验目的：了解同步互斥的具体实现以及对系统性能的影响，实现基于管程的条件变量机制，并用它解决进程同步问题。
- 实验内容：理解信号量机制实现方法，实现实现基于管程的条件变量机制和基于条件变量来解决哲学家就餐问题。 

## 实验8：文件系统
- 实验目的：了解基本的文件系统系统调用的实现方法，基于索引节点的文件系统和虚拟文件系统的具体实现。
- 实验内容：完成读文件操作和基于文件系统的执行程序机制，扩展基本文件系统，以支持目录，软链接等，扩展缓存机制，提供缓存的效率和性能。
