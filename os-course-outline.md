# 教学日历（教学大纲）（48学时）

大纲修定历史：
 * [v1](https://github.com/LearningOS/os-lectures/blob/c3933c913abdedbda15a25ad85e33f166fae38fc/os-course-outline.md)
 * [v2](https://github.com/LearningOS/os-lectures/blob/9ffa747971086b88f8045b04ae012c82ad837414/os-course-outline.md)：2020年10月21日提交给系里的版本；
 * v3:
 * v4: cooperate with 2021-spring labs

## 课程组织与基本目的

操作系统是计算机系统中负责管理各种软硬件资源的核心系统软件，掌握操作系统的基本原理及其设计实现技术是研究型大学计算机专业本科毕业生的基本要求。

本课程是计算机专业核心课，从计算机系统的视角进行内容组织与调整，以教学操作系统rcore和risc-v CPU为实验环境，讲授操作系统的概念、基本原理和实现技术，并介绍部分当前操作系统研究热点和论文，帮助学生了解和掌握大型复杂系统软件的分析方法和核心设计思路，并为学生充分利用操作系统功能进行应用软件研究和开发打下扎实的基础。

下面的每一讲是两个课时

### 教学内容

#### 第一讲 part 1 操作系统概述  

##### 1.1 课程概述与教学实验安排 

##### 1.2 什么是操作系统

##### 1.3 操作系统的演变

##### 1.4 操作系统结构

#### 第一讲 part2 操作系统与系统结构和程序设计语言 

##### 1.1 计算机系统 for OS （隔离，特权级，中断，I/O）

##### 1.2 系统启动流程

##### 1.3 多特权级切换

##### 1.4 C/Rust语言与OS内核

##### 1.5 Hello-World 操作系统

#### 第二讲 中断、异常和系统调用 

##### 2.1 基本概念与原理

##### 2.2 硬件架构支持

##### 2.3 中断处理机制

##### 2.4 系统调用/异常机制

##### 2.5 Kernel-Mode 操作系统

#### 第三讲 多道程序与分时多任务

##### 3.1 多道程序的放置与加载

##### 3.2 任务与任务切换

##### 3.3 协作式调度

##### 3.4 抢占式调度

##### 3.5 多道程序与分时多任务 OS

#### 第四讲 内存隔离

##### 4.1 计算机体系结构和内存层次概述

##### 4.2 非连续内存分配概述

##### 4.3 页式存储管理与多级页表

##### 4.4 RISC-V的页表机制

##### 4.5 用户态与内核态地址空间

##### 4.6  mem-isolation 操作系统

#### 第五讲 进程

##### 5.1 进程概念

##### 5.2 进程相关管理（fork/exec/wait/exit）

##### 5.3 进程间通信

##### 5.4 multi-process OS

#### 第六讲 文件系统概念

##### 6.1 文件系统、文件和目录 

##### 6.2 虚拟文件系统 

##### 6.3 文件管理 

##### 6.4 空闲空间管理

##### 6.5 File-System 操作系统

#### 第七讲  part1 物理内存管理 ：连续内存分配

##### 4.1 连续内存分配

##### 4.2 碎片整理

##### 4.3 伙伴系统 & * 其他（slab, region,etc）分配算法与实现

#### 第七讲 part2 物理内存管理: 非连续内存分配 

##### 5.2 页式与段式存储管理 

##### 5.4 反置页表

##### 5.5 段页式存储管理

##### 5.6 * 自映射机制

#### 第八讲 虚拟存储概念

##### 6.1 局部性原理

##### 6.2 覆盖和交换

##### 6.4 虚拟页式存储

##### 6.5 缺页异常

##### 6.6 RISC-V的缺页异常

#### 第九讲 虚拟存储：局部页面置换算法

##### 7.1 页面置换算法的概念

##### 7.2 最优/最近/最坏/先进先出/最近最久未使用 算法

##### 7.3 时钟置换算法和最不常用算法

##### 7.4 Belady现象和局部置换算法比较


#### 第十讲 虚拟存储：全局页面置换算法

##### 8.1 工作集置换算法

##### 8.2 缺页率置换算法

##### 8.3 抖动和负载控制

##### 8.4 面向缓存的页替换算法-FBR

##### 8.5 * 面向缓存的页替换算法-LRU-K 2Q

##### 8.6 * 面向缓存的页替换算法-LIRS

#### 第十一讲 进程、线程与协程

##### 9.5 * 进程地址空间与安全漏洞 

##### 10.7 * 思考fork的利与弊

##### 9.3 线程的概念

##### 9.4 * 协程的概念  即第二十讲 * 异步编程和异步I/O

##### 20.1 异步编程背景

##### 20.2 Rust语言中的Future

##### 20.3 Generator机制和async/await语言机制

##### 20.4 Self-Referential Structs & Pin机制

##### 20.5 Waker 和 Reactor 机制


#### 第十二讲 单处理机调度

##### 11.1 处理机调度概念

##### 11.2 调度准则

##### 11.3 先来先服务、短进程优先和最高响应比优先调度算法

##### 11.4 时间片轮转、多级反馈队列、公平共享调度算法和Stride调度算法

##### 11.5 实时调度

##### 11.6 优先级反置


#### 第十三讲 多处理机调度与实际操作系统调度机制

##### 12.1 对称多处理与多核架构

##### 12.2 多处理器调度概述

##### 12.3 * O(1)调度

##### 12.4 * CFS调度

##### 12.5 * BFS调度算法


#### 第十四讲 同步互斥

##### 13.1 同步互斥的背景

##### 13.2 现实生活中的同步问题

##### 13.3 临界区和禁用硬件中断同步方法

##### 13.4 基于软件的同步方法

##### 13.5 高级抽象的同步方法


#### 第十五讲 信号量与管程

##### 14.1 信号量的基本概念

##### 14.2 信号量的设计与实现

##### 14.3 管程的设计与实现

##### 14.4 哲学家就餐问题

##### 14.5 读者-写者问题

#### 第十六讲 死锁和并发错误检测

##### 15.1 死锁概念

##### 15.2 死锁处理方法

##### 15.3 银行家算法

##### 15.4 死锁检测 

##### 15.5 并发错误检测

#### 第十七讲 进程通信 

##### 16.1 进程通信概念

##### 16.2 信号

##### 16.3 * Linux信号机制

##### 16.4 消息队列和共享内存

##### 16.5 * dbus

##### 16.6 * binder




#### 第十八讲 文件系统实例

##### 18.1 FAT文件系统

##### 18.2 * EXT4文件系统 （日志文件系统）

##### 18.3 * ZFS文件系统

#### 第十九讲 I/O

##### 19.1 I/O特点

##### 19.2 I/O结构

##### 19.3 I/O数据传输

##### 19.4 磁盘调度

##### 19.5 * Linux I/O子系统

##### 

#### 第二十讲 * 虚拟化 

##### 21.1 虚拟化概述

##### 21.2 CPU虚拟化

##### 21.3 内存虚拟化

##### 21.4 I/O虚拟化



#### 第二十一讲 * 大实验汇报

##### 2~4组同学汇报大实验进展



#### 期末考试

### 教学实验

#### 实验0：操作系统实验环境和工具
- 实验目的：了解和熟悉操作系统实验的编译方法和流程、基于硬件模拟器的操作系统内核调试方法，复习Rust语言和RISC-V汇编语言。
- 实验内容：安装Linux操作系统、Rust编译工具和QEMU硬件模拟器，并熟悉这些系统和工具的使用方法。
#### 实验1：hello-world OS
- 实验目的：了解：在裸机上的执行环境，让应用与硬件隔离，简化了应用访问硬件的难度和复杂性。
- 实验内容：直接与硬件交互的系统程序的编译运行、 输出字符的方法、调试系统程序的方法。

#### 实验2：kernel-mode OS
- 实验目的：了解：操作系统利用硬件特权级机制，实现对操作系统自身的保护；应用在用户态通过系统调用得到内核态的内核服务；
  操作系统批处理机制支持多个程序的自动加载和运行。
- 实验内容：特权级机制、应用程序实现、批处理机制、特权级切换。

#### 实验3：multi-programming OS
- 实验目的：了解：操作系统通过协作机制/抢占机制支持程序主动/被动放弃处理器，提高系统效率。
- 实验内容：多道程序的放置与加载、任务切换、协作式调度、抢占式调度。 

#### 实验4：mem-isolation OS
- 实验目的：了解：操作系统通过动态内存分配机制、页表的虚实内存映射机制，加强内存安全，简化应用开发。
- 实验内容：动态内存分配、地址空间(Address Space)抽象、多级页表

#### 实验5：multi-process OS
- 实验目的：了解：操作系统建立了进程创建、执行、切换和结束的动态管理过程。
- 实验内容：进程(Process)抽象、进程管理。

#### 实验6：Inter-Process-Comm OS
- 实验目的：了解：操作系统通过进程间通信(Inter-Process-Comm)机制，让应用之间建立了有效的联系。
- 实验内容：进程间通信机制、管道(PIPE)机制。

#### 实验7：File-System OS
- 实验目的：了解：操作系统通过文件系统完成对程序和数据的持久保存与灵活的访问。
- 实验内容：基于inode方式的文件系统的设计与实现。 

#### 实验8：r/u Core OS
- 实验目的：了解：为支持更丰富的应用需求，操作系统需要改进与完善；通过完成一个完整的OS kernel的设计与实现，形成面向操作系统的系统思维。
- 实验内容：操作系统各组成部分关联关系的完善、操作系统各组成部分的改进与优化、对应用的进一步服务与支持。
